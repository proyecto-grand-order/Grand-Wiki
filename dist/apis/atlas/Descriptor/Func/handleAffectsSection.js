"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const api_connector_1 = require("@isaaczm/api-connector");
const OutputHelper_1 = require("../../Helper/OutputHelper");
const TraitDescription_1 = __importDefault(require("../TraitDescription"));
function default_1(sections, func, dataVal) {
    const section = sections.affects, parts = section.parts;
    if (func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_HPRATIO_LOW) {
        parts.push('(adicional con HP bajos)');
    }
    else if (typeof dataVal.Target === "number"
        && (func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_INDIVIDUAL
            || func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_STATE_INDIVIDUAL_FIX)) {
        parts.push(`<span>(adicional para objetivos con los rasgos ${new TraitDescription_1.default(dataVal.Target).export()})</span>`);
    }
    else if (dataVal.TargetList
        && dataVal.TargetList.length > 0
        && func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_INDIVIDUAL_SUM) {
        const traitIds = dataVal.TargetList, traits = traitIds.map(id => new TraitDescription_1.default(id).export());
        parts.push(`<span>(Bono por rasgo ${OutputHelper_1.mergeElements(traits, ' or ')} ${dataVal.ParamAddMaxCount ? `[Limit ${dataVal.ParamAddMaxCount}]` : null})</span>`);
    }
    else if (dataVal.TargetRarityList
        && dataVal.TargetRarityList.length > 0
        && func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_RARE) {
        parts.push(`<span>(bonus contra ${dataVal.TargetRarityList.join('/')} ${dataVal.TargetRarityList.length > 1 ? 'rarities' : 'rarity'})</span>`);
    }
    else if (func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_PIERCE) {
        parts.push('(penetra la defensa)');
    }
    if (func.funcType === api_connector_1.Func.FuncType.ENEMY_ENCOUNT_COPY_RATE_UP
        || func.funcType === api_connector_1.Func.FuncType.ENEMY_ENCOUNT_RATE_UP
        || func.funcType === api_connector_1.Func.FuncType.EVENT_DROP_UP) {
        if (dataVal.Individuality) {
            parts.push(`<span>con ${new TraitDescription_1.default(Number(dataVal.Individuality)).export()}</span>`);
        }
        if (dataVal.EventId) {
            parts.push(`<span>Durante el evento ${new TraitDescription_1.default(Number(dataVal.EventId))}</span>`);
        }
    }
    if (func.funcquestTvals.length) {
        parts.push('Si esta en el campo de batalla');
        parts.push(OutputHelper_1.mergeElements(func.funcquestTvals.map(trait => new TraitDescription_1.default(trait).export()), ' & '));
    }
    if (func.functvals.length) {
        parts.push('para objetivos');
        if (func.functvals.length > 1) {
            parts.push('all');
        }
        func.functvals.forEach((trait, index) => {
            if (index > 0)
                parts.push('&');
            parts.push(`${new TraitDescription_1.default(trait).export()}`);
        });
    }
    if (!parts.length) {
        section.showing = false;
    }
}
exports.default = default_1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFuZGxlQWZmZWN0c1NlY3Rpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvYXBpcy9hdGxhcy9EZXNjcmlwdG9yL0Z1bmMvaGFuZGxlQWZmZWN0c1NlY3Rpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSwwREFBdUQ7QUFDdkQsNERBQTBEO0FBQzFELDJFQUFtRDtBQUduRCxtQkFBeUIsUUFBZ0MsRUFBRSxJQUFlLEVBQUUsT0FBd0I7SUFDaEcsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLE9BQU8sRUFDNUIsS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUM7SUFFMUIsSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLHFCQUFxQixFQUFFO1FBQ3ZELEtBQUssQ0FBQyxJQUFJLENBQUMsMEJBQTBCLENBQUMsQ0FBQztLQUMxQztTQUFNLElBQUksT0FBTyxPQUFPLENBQUMsTUFBTSxLQUFLLFFBQVE7V0FDdEMsQ0FDQyxJQUFJLENBQUMsUUFBUSxLQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLG9CQUFvQjtlQUNqRCxJQUFJLENBQUMsUUFBUSxLQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLDhCQUE4QixDQUNwRSxFQUNIO1FBQ0UsS0FBSyxDQUFDLElBQUksQ0FBQyxrREFBa0QsSUFBSSwwQkFBZ0IsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0tBQ3pIO1NBQU0sSUFDSCxPQUFPLENBQUMsVUFBVTtXQUNmLE9BQU8sQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUM7V0FDN0IsSUFBSSxDQUFDLFFBQVEsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyx3QkFBd0IsRUFDN0Q7UUFDRSxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsVUFBVSxFQUMvQixNQUFNLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FB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RCxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTtRQUNmLE9BQU8sQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO0tBQzNCO0FBRUwsQ0FBQztBQTdFRCw0QkE2RUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEYXRhVmFsLCBGdW5jIH0gZnJvbSBcIkBpc2FhY3ptL2FwaS1jb25uZWN0b3JcIjtcbmltcG9ydCB7IG1lcmdlRWxlbWVudHMgfSBmcm9tIFwiLi4vLi4vSGVscGVyL091dHB1dEhlbHBlclwiO1xuaW1wb3J0IFRyYWl0RGVzY3JpcHRpb24gZnJvbSBcIi4uL1RyYWl0RGVzY3JpcHRpb25cIjtcbmltcG9ydCB7IEZ1bmNEZXNjcmlwdG9yU2VjdGlvbnMgfSBmcm9tIFwiLi9GdW5jRGVzY3JpcHRvclNlY3Rpb25zXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIChzZWN0aW9uczogRnVuY0Rlc2NyaXB0b3JTZWN0aW9ucywgZnVuYzogRnVuYy5GdW5jLCBkYXRhVmFsOiBEYXRhVmFsLkRhdGFWYWwpOiB2b2lkIHtcbiAgICBjb25zdCBzZWN0aW9uID0gc2VjdGlvbnMuYWZmZWN0cyxcbiAgICAgICAgcGFydHMgPSBzZWN0aW9uLnBhcnRzO1xuXG4gICAgaWYgKGZ1bmMuZnVuY1R5cGUgPT09IEZ1bmMuRnVuY1R5cGUuREFNQUdFX05QX0hQUkFUSU9fTE9XKSB7XG4gICAgICAgIHBhcnRzLnB1c2goJyhhZGljaW9uYWwgY29uIEhQIGJham9zKScpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRhdGFWYWwuVGFyZ2V0ID09PSBcIm51bWJlclwiXG4gICAgICAgICYmIChcbiAgICAgICAgICAgIGZ1bmMuZnVuY1R5cGUgPT09IEZ1bmMuRnVuY1R5cGUuREFNQUdFX05QX0lORElWSURVQUxcbiAgICAgICAgICAgIHx8IGZ1bmMuZnVuY1R5cGUgPT09IEZ1bmMuRnVuY1R5cGUuREFNQUdFX05QX1NUQVRFX0lORElWSURVQUxfRklYXG4gICAgICAgIClcbiAgICApIHtcbiAgICAgICAgcGFydHMucHVzaChgPHNwYW4+KGFkaWNpb25hbCBwYXJhIG9iamV0aXZvcyBjb24gbG9zIHJhc2dvcyAke25ldyBUcmFpdERlc2NyaXB0aW9uKGRhdGFWYWwuVGFyZ2V0KS5leHBvcnQoKX0pPC9zcGFuPmApO1xuICAgIH0gZWxzZSBpZiAoXG4gICAgICAgIGRhdGFWYWwuVGFyZ2V0TGlzdFxuICAgICAgICAmJiBkYXRhVmFsLlRhcmdldExpc3QubGVuZ3RoID4gMFxuICAgICAgICAmJiBmdW5jLmZ1bmNUeXBlID09PSBGdW5jLkZ1bmNUeXBlLkRBTUFHRV9OUF9JTkRJVklEVUFMX1NVTVxuICAgICkge1xuICAgICAgICBjb25zdCB0cmFpdElkcyA9IGRhdGFWYWwuVGFyZ2V0TGlzdCxcbiAgICAgICAgICAgIHRyYWl0cyA9IHRyYWl0SWRzLm1hcChpZCA9PiBuZXcgVHJhaXREZXNjcmlwdGlvbihpZCkuZXhwb3J0KCkpO1xuXG4gICAgICAgIHBhcnRzLnB1c2goYDxzcGFuPihCb25vIHBvciByYXNnbyAke21lcmdlRWxlbWVudHModHJhaXRzLCAnIG9yICcpfSAke2RhdGFWYWwuUGFyYW1BZGRNYXhDb3VudCA/IGBbTGltaXQgJHtkYXRhVmFsLlBhcmFtQWRkTWF4Q291bnR9XWAgOiBudWxsXG4gICAgICAgICAgICB9KTwvc3Bhbj5gKTtcbiAgICB9IGVsc2UgaWYgKFxuICAgICAgICBkYXRhVmFsLlRhcmdldFJhcml0eUxpc3RcbiAgICAgICAgJiYgZGF0YVZhbC5UYXJnZXRSYXJpdHlMaXN0Lmxlbmd0aCA+IDBcbiAgICAgICAgJiYgZnVuYy5mdW5jVHlwZSA9PT0gRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlBfUkFSRVxuICAgICkge1xuICAgICAgICBwYXJ0cy5wdXNoKGA8c3Bhbj4oYm9udXMgY29udHJhICR7ZGF0YVZhbC5UYXJnZXRSYXJpdHlMaXN0LmpvaW4oJy8nKX0gJHtkYXRhVmFsLlRhcmdldFJhcml0eUxpc3QubGVuZ3RoID4gMSA/ICdyYXJpdGllcycgOiAncmFyaXR5J1xuICAgICAgICAgICAgfSk8L3NwYW4+YClcbiAgICB9IGVsc2UgaWYgKGZ1bmMuZnVuY1R5cGUgPT09IEZ1bmMuRnVuY1R5cGUuREFNQUdFX05QX1BJRVJDRSkge1xuICAgICAgICBwYXJ0cy5wdXNoKCcocGVuZXRyYSBsYSBkZWZlbnNhKScpO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgICAgZnVuYy5mdW5jVHlwZSA9PT0gRnVuYy5GdW5jVHlwZS5FTkVNWV9FTkNPVU5UX0NPUFlfUkFURV9VUFxuICAgICAgICB8fCBmdW5jLmZ1bmNUeXBlID09PSBGdW5jLkZ1bmNUeXBlLkVORU1ZX0VOQ09VTlRfUkFURV9VUFxuICAgICAgICB8fCBmdW5jLmZ1bmNUeXBlID09PSBGdW5jLkZ1bmNUeXBlLkVWRU5UX0RST1BfVVBcbiAgICApIHtcbiAgICAgICAgaWYgKGRhdGFWYWwuSW5kaXZpZHVhbGl0eSkge1xuICAgICAgICAgICAgcGFydHMucHVzaChgPHNwYW4+Y29uICR7bmV3IFRyYWl0RGVzY3JpcHRpb24oTnVtYmVyKGRhdGFWYWwuSW5kaXZpZHVhbGl0eSkpLmV4cG9ydCgpfTwvc3Bhbj5gKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGFWYWwuRXZlbnRJZCkge1xuICAgICAgICAgICAgcGFydHMucHVzaChgPHNwYW4+RHVyYW50ZSBlbCBldmVudG8gJHtuZXcgVHJhaXREZXNjcmlwdGlvbihOdW1iZXIoZGF0YVZhbC5FdmVudElkKSl9PC9zcGFuPmApXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZnVuYy5mdW5jcXVlc3RUdmFscy5sZW5ndGgpIHtcbiAgICAgICAgcGFydHMucHVzaCgnU2kgZXN0YSBlbiBlbCBjYW1wbyBkZSBiYXRhbGxhJyk7XG4gICAgICAgIHBhcnRzLnB1c2goXG4gICAgICAgICAgICBtZXJnZUVsZW1lbnRzKFxuICAgICAgICAgICAgICAgIGZ1bmMuZnVuY3F1ZXN0VHZhbHMubWFwKHRyYWl0ID0+IG5ldyBUcmFpdERlc2NyaXB0aW9uKHRyYWl0KS5leHBvcnQoKSksXG4gICAgICAgICAgICAgICAgJyAmICdcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoZnVuYy5mdW5jdHZhbHMubGVuZ3RoKSB7XG4gICAgICAgIHBhcnRzLnB1c2goJ3BhcmEgb2JqZXRpdm9zJyk7XG5cbiAgICAgICAgaWYgKGZ1bmMuZnVuY3R2YWxzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHBhcnRzLnB1c2goJ2FsbCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuYy5mdW5jdHZhbHMuZm9yRWFjaCgodHJhaXQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPiAwKVxuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2goJyYnKTtcblxuICAgICAgICAgICAgcGFydHMucHVzaChgJHtuZXcgVHJhaXREZXNjcmlwdGlvbih0cmFpdCkuZXhwb3J0KCl9YCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICghcGFydHMubGVuZ3RoKSB7XG4gICAgICAgIHNlY3Rpb24uc2hvd2luZyA9IGZhbHNlO1xuICAgIH1cblxufVxuIl19