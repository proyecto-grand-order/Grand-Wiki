"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.funcDescriptions = exports.TranslateFuncDescriptions = exports.wait = void 0;
const api_connector_1 = require("@isaaczm/api-connector");
const node_fetch_1 = __importDefault(require("node-fetch"));
const BuffDescription_1 = __importDefault(require("../BuffDescription"));
const TraitDescription_1 = __importDefault(require("../TraitDescription"));
const wait = (ms) => {
    var start = Date.now(), now = start;
    while (now - start < ms) {
        now = Date.now();
    }
};
exports.wait = wait;
const TranslateFuncDescriptions = async () => {
    const req = await node_fetch_1.default('https://script.google.com/macros/s/AKfycbzQK3RpvN2GqFvJ_3Xnyl_5saSvJOns8qrxctfih9CLVEuS5Rm1oNtMfVEviKOKCtU/exec');
    const db = await req.json();
    for (const Func of db.data) {
        if (Func['ESPAÑOL'].length > 0) {
            const type = Func['Func'];
            exports.funcDescriptions.set(type, Func['ESPAÑOL']);
        }
    }
};
exports.TranslateFuncDescriptions = TranslateFuncDescriptions;
exports.funcDescriptions = new Map([
    [api_connector_1.Func.FuncType.ABSORB_NPTURN, 'Absorb Charge'],
    [api_connector_1.Func.FuncType.ADD_STATE, 'Apply Buff'],
    [api_connector_1.Func.FuncType.ADD_STATE_SHORT, 'Apply Buff'],
    [api_connector_1.Func.FuncType.CARD_RESET, 'Shuffle Cards'],
    [api_connector_1.Func.FuncType.DAMAGE_NP, 'Deal Damage'],
    [api_connector_1.Func.FuncType.DAMAGE_NP_HPRATIO_LOW, 'Deal Damage with Bonus for Low Health'],
    [api_connector_1.Func.FuncType.DAMAGE_NP_INDIVIDUAL, 'Deal Damage with Bonus to Trait'],
    [api_connector_1.Func.FuncType.DAMAGE_NP_INDIVIDUAL_SUM, 'Deal Damage with Bonus per Trait'],
    [api_connector_1.Func.FuncType.DAMAGE_NP_PIERCE, 'Deal Damage that pierces defense'],
    [api_connector_1.Func.FuncType.DAMAGE_NP_RARE, 'Deal Damage with Bonus to Rarity'],
    [api_connector_1.Func.FuncType.DAMAGE_NP_STATE_INDIVIDUAL_FIX, 'Deal Damage with Bonus to Trait'],
    [api_connector_1.Func.FuncType.DELAY_NPTURN, 'Drain Charge'],
    [api_connector_1.Func.FuncType.EVENT_DROP_UP, 'Increase Drop Amount'],
    [api_connector_1.Func.FuncType.ENEMY_ENCOUNT_COPY_RATE_UP, 'Create Clone of Enemy'],
    [api_connector_1.Func.FuncType.ENEMY_ENCOUNT_RATE_UP, 'Improve Appearance Rate of Enemy'],
    [api_connector_1.Func.FuncType.EXP_UP, 'Increase Master Exp'],
    [api_connector_1.Func.FuncType.EXTEND_SKILL, 'Increase Cooldowns'],
    [api_connector_1.Func.FuncType.FIX_COMMANDCARD, 'Lock Command Cards'],
    [api_connector_1.Func.FuncType.FORCE_INSTANT_DEATH, 'Force Instant Death'],
    [api_connector_1.Func.FuncType.GAIN_HP, 'Restore HP'],
    [api_connector_1.Func.FuncType.GAIN_HP_FROM_TARGETS, 'Absorb HP'],
    [api_connector_1.Func.FuncType.GAIN_HP_PER, 'Restore HP to Percent'],
    [api_connector_1.Func.FuncType.GAIN_NP, 'Charge NP'],
    [api_connector_1.Func.FuncType.GAIN_NP_BUFF_INDIVIDUAL_SUM, 'Charge NP per Trait'],
    [api_connector_1.Func.FuncType.GAIN_NP_FROM_TARGETS, 'Absorb NP'],
    [api_connector_1.Func.FuncType.GAIN_STAR, 'Gain Critical Stars'],
    [api_connector_1.Func.FuncType.HASTEN_NPTURN, 'Increase Charge'],
    [api_connector_1.Func.FuncType.INSTANT_DEATH, 'Apply Death'],
    [api_connector_1.Func.FuncType.LOSS_HP, 'Drain HP'],
    [api_connector_1.Func.FuncType.LOSS_HP_SAFE, 'Drain HP without killing'],
    [api_connector_1.Func.FuncType.LOSS_NP, 'Drain NP'],
    [api_connector_1.Func.FuncType.LOSS_STAR, 'Remove Critical Stars'],
    [api_connector_1.Func.FuncType.NONE, 'No Effect'],
    [api_connector_1.Func.FuncType.QP_DROP_UP, 'Increase QP Reward'],
    [api_connector_1.Func.FuncType.QP_UP, 'Increase QP Reward'],
    [api_connector_1.Func.FuncType.REPLACE_MEMBER, 'Swap members'],
    [api_connector_1.Func.FuncType.SERVANT_FRIENDSHIP_UP, 'Increase Bond Gain'],
    [api_connector_1.Func.FuncType.SHORTEN_SKILL, 'Reduce Cooldowns'],
    [api_connector_1.Func.FuncType.SUB_STATE, 'Remove Effects'],
    [api_connector_1.Func.FuncType.USER_EQUIP_EXP_UP, 'Increase Mystic Code Exp'],
]);
function handleBuffActionSection(sections, func, dataVal) {
    var _a, _b, _c, _d;
    const section = sections.action, parts = section.parts;
    parts.push('Aplica');
    func.buffs.forEach((buff, index) => {
        if (index > 0)
            parts.push('&');
        const Buff = new BuffDescription_1.default().export(buff);
        parts.push(Buff);
    });
    if (((_a = func.buffs[0]) === null || _a === void 0 ? void 0 : _a.type) === api_connector_1.Buff.BuffType.FIELD_INDIVIDUALITY
        || ((_b = func.buffs[0]) === null || _b === void 0 ? void 0 : _b.type) === api_connector_1.Buff.BuffType.CHANGE_COMMAND_CARD_TYPE) {
        sections.amount.preposition = ' ';
    }
    sections.target.preposition = 'a';
    if (((_c = func.buffs[0]) === null || _c === void 0 ? void 0 : _c.type) === api_connector_1.Buff.BuffType.COMMANDATTACK_FUNCTION
        || ((_d = func.buffs[0]) === null || _d === void 0 ? void 0 : _d.type) === api_connector_1.Buff.BuffType.NPATTACK_PREV_BUFF) {
        sections.target.preposition = 'para';
    }
}
function handleCleanseActionSection(sections, func, dataVal) {
    var _a, _b;
    const section = sections.action, parts = section.parts;
    parts.push((_a = exports.funcDescriptions.get(func.funcType)) !== null && _a !== void 0 ? _a : func.funcType);
    if ((_b = func.traitVals) === null || _b === void 0 ? void 0 : _b.length) {
        parts.push('con');
        func.traitVals.forEach((trait, index) => {
            if (index > 0)
                parts.push('o');
            parts.push(new TraitDescription_1.default(trait).export());
        });
    }
    sections.target.preposition = 'en';
}
function handleChargeNpPerTraitActionSection(sections, func, dataVal) {
    var _a;
    const section = sections.action, parts = section.parts;
    parts.push('Carga NP por');
    if ((_a = func.traitVals) === null || _a === void 0 ? void 0 : _a.length) {
        func.traitVals.forEach((trait, index) => {
            if (index > 0)
                parts.push('&');
            parts.push(new TraitDescription_1.default(trait).export());
        });
    }
    parts.push('traits');
    sections.amount.preposition = 'por';
    sections.target.preposition = 'para';
}
function default_1(sections, func, dataVal) {
    var _a;
    const section = sections.action, parts = section.parts;
    if (func.funcType === api_connector_1.Func.FuncType.ADD_STATE || func.funcType === api_connector_1.Func.FuncType.ADD_STATE_SHORT) {
        handleBuffActionSection(sections, func, dataVal);
        return;
    }
    else if (func.funcType === api_connector_1.Func.FuncType.SUB_STATE) {
        handleCleanseActionSection(sections, func, dataVal);
        return;
    }
    else if (func.funcType === api_connector_1.Func.FuncType.GAIN_NP_BUFF_INDIVIDUAL_SUM) {
        handleChargeNpPerTraitActionSection(sections, func, dataVal);
        return;
    }
    else if (func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP
        || func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_HPRATIO_LOW
        || func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_INDIVIDUAL
        || func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_INDIVIDUAL_SUM
        || func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_PIERCE
        || func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_RARE
        || func.funcType === api_connector_1.Func.FuncType.DAMAGE_NP_STATE_INDIVIDUAL_FIX) {
        parts.push('Daña');
        sections.amount.preposition = 'un';
        return;
    }
    switch (func.funcType) {
        case api_connector_1.Func.FuncType.ABSORB_NPTURN:
        case api_connector_1.Func.FuncType.GAIN_HP_FROM_TARGETS:
        case api_connector_1.Func.FuncType.GAIN_NP_FROM_TARGETS:
            sections.amount.preposition = ' ';
            sections.target.preposition = 'al';
            break;
        case api_connector_1.Func.FuncType.CARD_RESET:
        case api_connector_1.Func.FuncType.GAIN_STAR:
        case api_connector_1.Func.FuncType.LOSS_STAR:
        case api_connector_1.Func.FuncType.NONE:
            sections.target.showing = false;
            break;
        case api_connector_1.Func.FuncType.DELAY_NPTURN:
        case api_connector_1.Func.FuncType.LOSS_HP:
        case api_connector_1.Func.FuncType.LOSS_HP_SAFE:
        case api_connector_1.Func.FuncType.LOSS_NP:
            sections.amount.preposition = ' ';
            sections.target.preposition = 'al';
            break;
        case api_connector_1.Func.FuncType.ENEMY_ENCOUNT_COPY_RATE_UP:
        case api_connector_1.Func.FuncType.ENEMY_ENCOUNT_RATE_UP:
        case api_connector_1.Func.FuncType.FIX_COMMANDCARD:
            sections.amount.showing = false;
            sections.target.showing = false;
            break;
        case api_connector_1.Func.FuncType.EVENT_DROP_UP:
        case api_connector_1.Func.FuncType.EXP_UP:
        case api_connector_1.Func.FuncType.QP_DROP_UP:
        case api_connector_1.Func.FuncType.QP_UP:
        case api_connector_1.Func.FuncType.SERVANT_FRIENDSHIP_UP:
        case api_connector_1.Func.FuncType.USER_EQUIP_EXP_UP:
            sections.chance.showing = false;
            sections.amount.preposition = 'un';
            sections.target.showing = false;
            break;
        case api_connector_1.Func.FuncType.EXTEND_SKILL:
        case api_connector_1.Func.FuncType.GAIN_HP:
        case api_connector_1.Func.FuncType.GAIN_NP:
        case api_connector_1.Func.FuncType.HASTEN_NPTURN:
        case api_connector_1.Func.FuncType.SHORTEN_SKILL:
            sections.amount.preposition = ' ';
            sections.target.preposition = 'a';
            break;
        case api_connector_1.Func.FuncType.FORCE_INSTANT_DEATH:
        case api_connector_1.Func.FuncType.INSTANT_DEATH:
            sections.amount.showing = false;
            sections.target.preposition = 'en';
            break;
        case api_connector_1.Func.FuncType.GAIN_HP_PER:
            sections.amount.preposition = ' ';
            sections.target.preposition = 'al';
            break;
        case api_connector_1.Func.FuncType.REPLACE_MEMBER:
            sections.amount.showing = false;
            sections.target.preposition = 'con';
            break;
    }
    parts.push((_a = exports.funcDescriptions.get(func.funcType)) !== null && _a !== void 0 ? _a : func.funcType);
}
exports.default = default_1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFuZGxlQWN0aW9uU2VjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9hcGlzL2F0bGFzL0Rlc2NyaXB0b3IvRnVuYy9oYW5kbGVBY3Rpb25TZWN0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLDBEQUFxRTtBQUNyRSw0REFBK0I7QUFDL0IseUVBQWlEO0FBQ2pELDJFQUFtRDtBQUc1QyxNQUFNLElBQUksR0FBRyxDQUFDLEVBQUUsRUFBRSxFQUFFO0lBQ3ZCLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFDbEIsR0FBRyxHQUFHLEtBQUssQ0FBQztJQUNoQixPQUFPLEdBQUcsR0FBRyxLQUFLLEdBQUcsRUFBRSxFQUFFO1FBQ3JCLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7S0FDcEI7QUFDTCxDQUFDLENBQUE7QUFOWSxRQUFBLElBQUksUUFNaEI7QUFFTSxNQUFNLHlCQUF5QixHQUFHLEtBQUssSUFBbUIsRUFBRTtJQUMvRCxNQUFNLEdBQUcsR0FBRyxNQUFNLG9CQUFLLENBQUMsaUhBQWlILENBQUMsQ0FBQTtJQUMxSSxNQUFNLEVBQUUsR0FBRyxNQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUM1QixLQUFLLE1BQU0sSUFBSSxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUU7UUFDeEIsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUM1QixNQUFNLElBQUksR0FBa0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFBO1lBQ3hDLHdCQUFnQixDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUE7U0FDOUM7S0FDSjtBQUNMLENBQUMsQ0FBQTtBQVRZLFFBQUEseUJBQXlCLDZCQVNyQztBQUVZLFFBQUEsZ0JBQWdCLEdBQUcsSUFBSSxHQUFHLENBQXdCO0lBQzNELENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxFQUFFLGVBQWUsQ0FBQztJQUM5QyxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUM7SUFDdkMsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLEVBQUUsWUFBWSxDQUFDO0lBQzdDLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxFQUFFLGVBQWUsQ0FBQztJQUMzQyxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBRSxhQUFhLENBQUM7SUFDeEMsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsRUFBRSx1Q0FBdUMsQ0FBQztJQUM5RSxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLG9CQUFvQixFQUFFLGlDQUFpQyxDQUFDO0lBQ3ZFLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsd0JBQXdCLEVBQUUsa0NBQWtDLENBQUM7SUFDNUUsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxrQ0FBa0MsQ0FBQztJQUNwRSxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsRUFBRSxrQ0FBa0MsQ0FBQztJQUNsRSxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLDhCQUE4QixFQUFFLGlDQUFpQyxDQUFDO0lBQ2pGLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFFLGNBQWMsQ0FBQztJQUM1QyxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsRUFBRSxzQkFBc0IsQ0FBQztJQUNyRCxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLDBCQUEwQixFQUFFLHVCQUF1QixDQUFDO0lBQ25FLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMscUJBQXFCLEVBQUUsa0NBQWtDLENBQUM7SUFDekUsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUscUJBQXFCLENBQUM7SUFDN0MsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLEVBQUUsb0JBQW9CLENBQUM7SUFDbEQsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLEVBQUUsb0JBQW9CLENBQUM7SUFDckQsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxxQkFBcUIsQ0FBQztJQUMxRCxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxZQUFZLENBQUM7SUFDckMsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxXQUFXLENBQUM7SUFDakQsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsdUJBQXVCLENBQUM7SUFDcEQsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDO0lBQ3BDLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsMkJBQTJCLEVBQUUscUJBQXFCLENBQUM7SUFDbEUsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxXQUFXLENBQUM7SUFDakQsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUscUJBQXFCLENBQUM7SUFDaEQsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEVBQUUsaUJBQWlCLENBQUM7SUFDaEQsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEVBQUUsYUFBYSxDQUFDO0lBQzVDLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQztJQUNuQyxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksRUFBRSwwQkFBMEIsQ0FBQztJQUN4RCxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUM7SUFDbkMsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsdUJBQXVCLENBQUM7SUFDbEQsQ0FBQyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsV0FBVyxDQUFDO0lBQ2pDLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxFQUFFLG9CQUFvQixDQUFDO0lBQ2hELENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLG9CQUFvQixDQUFDO0lBQzNDLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsY0FBYyxFQUFFLGNBQWMsQ0FBQztJQUM5QyxDQUFDLG9CQUFJLENBQUMsUUFBUSxDQUFDLHFCQUFxQixFQUFFLG9CQUFvQixDQUFDO0lBQzNELENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxFQUFFLGtCQUFrQixDQUFDO0lBQ2pELENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFLGdCQUFnQixDQUFDO0lBQzNDLENBQUMsb0JBQUksQ0FBQyxRQUFRLENBQUMsaUJBQWlCLEVBQUUsMEJBQTBCLENBQUM7Q0FDaEUsQ0FBQyxDQUFDO0FBRUgsU0FBUyx1QkFBdUIsQ0FBQyxRQUFnQyxFQUFFLElBQWUsRUFBRSxPQUF3Qjs7SUFDeEcsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLE1BQU0sRUFDM0IsS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUM7SUFFMUIsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUVyQixJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsRUFBRTtRQUMvQixJQUFJLEtBQUssR0FBRyxDQUFDO1lBQ1QsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUVwQixNQUFNLElBQUksR0FBRyxJQUFJLHlCQUFlLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDaEQsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNyQixDQUFDLENBQUMsQ0FBQztJQUVILElBQ0ksQ0FBQSxNQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLDBDQUFFLElBQUksTUFBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUI7V0FDdEQsQ0FBQSxNQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLDBDQUFFLElBQUksTUFBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyx3QkFBd0IsRUFDbkU7UUFDRSxRQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUM7S0FDckM7SUFFRCxRQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUM7SUFDbEMsSUFDSSxDQUFBLE1BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsMENBQUUsSUFBSSxNQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLHNCQUFzQjtXQUN6RCxDQUFBLE1BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsMENBQUUsSUFBSSxNQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLGtCQUFrQixFQUM3RDtRQUNFLFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxHQUFHLE1BQU0sQ0FBQztLQUN4QztBQUNMLENBQUM7QUFHRCxTQUFTLDBCQUEwQixDQUFDLFFBQWdDLEVBQUUsSUFBZSxFQUFFLE9BQXdCOztJQUMzRyxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsTUFBTSxFQUMzQixLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQztJQUUxQixLQUFLLENBQUMsSUFBSSxDQUFDLE1BQUEsd0JBQWdCLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsbUNBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBRWpFLElBQUksTUFBQSxJQUFJLENBQUMsU0FBUywwQ0FBRSxNQUFNLEVBQUU7UUFDeEIsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUVsQixJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRTtZQUNwQyxJQUFJLEtBQUssR0FBRyxDQUFDO2dCQUNULEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFFcEIsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLDBCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7S0FDTjtJQUVELFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztBQUN2QyxDQUFDO0FBRUQsU0FBUyxtQ0FBbUMsQ0FBQyxRQUFnQyxFQUFFLElBQWUsRUFBRSxPQUF3Qjs7SUFDcEgsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLE1BQU0sRUFDM0IsS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUM7SUFFMUIsS0FBSyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUUzQixJQUFJLE1BQUEsSUFBSSxDQUFDLFNBQVMsMENBQUUsTUFBTSxFQUFFO1FBQ3hCLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFO1lBQ3BDLElBQUksS0FBSyxHQUFHLENBQUM7Z0JBQ1QsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUVwQixLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksMEJBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztLQUNOO0lBRUQsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUVyQixRQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7SUFDcEMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxXQUFXLEdBQUcsTUFBTSxDQUFDO0FBQ3pDLENBQUM7QUFHRCxtQkFBeUIsUUFBZ0MsRUFBRSxJQUFlLEVBQUUsT0FBd0I7O0lBQ2hHLE1BQU0sT0FBTyxHQUFHLFFBQVEsQ0FBQyxNQUFNLEVBQzNCLEtBQUssR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO0lBRTFCLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLEVBQUU7UUFDOUYsdUJBQXVCLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztRQUVqRCxPQUFPO0tBQ1Y7U0FBTSxJQUFJLElBQUksQ0FBQyxRQUFRLEtBQUssb0JBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFO1FBQ2xELDBCQUEwQixDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFcEQsT0FBTztLQUNWO1NBQU0sSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLDJCQUEyQixFQUFFO1FBQ3BFLG1DQUFtQyxDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFN0QsT0FBTztLQUNWO1NBQU0sSUFDSCxJQUFJLENBQUMsUUFBUSxLQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLFNBQVM7V0FDdEMsSUFBSSxDQUFDLFFBQVEsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUI7V0FDckQsSUFBSSxDQUFDLFFBQVEsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxvQkFBb0I7V0FDcEQsSUFBSSxDQUFDLFFBQVEsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyx3QkFBd0I7V0FDeEQsSUFBSSxDQUFDLFFBQVEsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0I7V0FDaEQsSUFBSSxDQUFDLFFBQVEsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxjQUFjO1dBQzlDLElBQUksQ0FBQyxRQUFRLEtBQUssb0JBQUksQ0FBQyxRQUFRLENBQUMsOEJBQThCLEVBQ25FO1FBQ0UsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNuQixRQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7UUFDbkMsT0FBTztLQUNWO0lBRUQsUUFBUSxJQUFJLENBQUMsUUFBUSxFQUFFO1FBQ25CLEtBQUssb0JBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDO1FBQ2pDLEtBQUssb0JBQUksQ0FBQyxRQUFRLENBQUMsb0JBQW9CLENBQUM7UUFDeEMsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxvQkFBb0I7WUFDbkMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDO1lBQ2xDLFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztZQUNuQyxNQUFNO1FBQ1YsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUM7UUFDOUIsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUM7UUFDN0IsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUM7UUFDN0IsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJO1lBQ25CLFFBQVEsQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNoQyxNQUFNO1FBQ1YsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUM7UUFDaEMsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7UUFDM0IsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUM7UUFDaEMsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPO1lBQ3RCLFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQztZQUNsQyxRQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7WUFDbkMsTUFBTTtRQUNWLEtBQUssb0JBQUksQ0FBQyxRQUFRLENBQUMsMEJBQTBCLENBQUM7UUFDOUMsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQztRQUN6QyxLQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLGVBQWU7WUFDOUIsUUFBUSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQ2hDLFFBQVEsQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNoQyxNQUFNO1FBQ1YsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUM7UUFDakMsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUM7UUFDMUIsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUM7UUFDOUIsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUM7UUFDekIsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQztRQUN6QyxLQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQjtZQUNoQyxRQUFRLENBQUMsTUFBTSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDaEMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO1lBQ25DLFFBQVEsQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNoQyxNQUFNO1FBQ1YsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUM7UUFDaEMsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7UUFDM0IsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7UUFDM0IsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUM7UUFDakMsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhO1lBQzVCLFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQztZQUNsQyxRQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUM7WUFDbEMsTUFBTTtRQUNWLEtBQUssb0JBQUksQ0FBQyxRQUFRLENBQUMsbUJBQW1CLENBQUM7UUFDdkMsS0FBSyxvQkFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhO1lBQzVCLFFBQVEsQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNoQyxRQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7WUFDbkMsTUFBTTtRQUNWLEtBQUssb0JBQUksQ0FBQyxRQUFRLENBQUMsV0FBVztZQUMxQixRQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUM7WUFDbEMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO1lBQ25DLE1BQU07UUFDVixLQUFLLG9CQUFJLENBQUMsUUFBUSxDQUFDLGNBQWM7WUFDN0IsUUFBUSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQ2hDLFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztZQUNwQyxNQUFNO0tBQ2I7SUFDRCxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQUEsd0JBQWdCLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsbUNBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3JFLENBQUM7QUF6RkQsNEJBeUZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQnVmZiwgRGF0YVZhbCwgRnVuYywgUmVnaW9uIH0gZnJvbSBcIkBpc2FhY3ptL2FwaS1jb25uZWN0b3JcIjtcbmltcG9ydCBmZXRjaCBmcm9tIFwibm9kZS1mZXRjaFwiO1xuaW1wb3J0IEJ1ZmZEZXNjcmlwdGlvbiBmcm9tIFwiLi4vQnVmZkRlc2NyaXB0aW9uXCI7XG5pbXBvcnQgVHJhaXREZXNjcmlwdGlvbiBmcm9tIFwiLi4vVHJhaXREZXNjcmlwdGlvblwiO1xuaW1wb3J0IHsgRnVuY0Rlc2NyaXB0b3JTZWN0aW9ucyB9IGZyb20gXCIuL0Z1bmNEZXNjcmlwdG9yU2VjdGlvbnNcIjtcblxuZXhwb3J0IGNvbnN0IHdhaXQgPSAobXMpID0+IHtcbiAgICB2YXIgc3RhcnQgPSBEYXRlLm5vdygpLFxuICAgICAgICBub3cgPSBzdGFydDtcbiAgICB3aGlsZSAobm93IC0gc3RhcnQgPCBtcykge1xuICAgICAgICBub3cgPSBEYXRlLm5vdygpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IFRyYW5zbGF0ZUZ1bmNEZXNjcmlwdGlvbnMgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgY29uc3QgcmVxID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vc2NyaXB0Lmdvb2dsZS5jb20vbWFjcm9zL3MvQUtmeWNielFLM1Jwdk4yR3FGdkpfM1hueWxfNXNhU3ZKT25zOHFyeGN0ZmloOUNMVkV1UzVSbTFvTnRNZlZFdmlLT0tDdFUvZXhlYycpXG4gICAgY29uc3QgZGIgPSBhd2FpdCByZXEuanNvbigpO1xuICAgIGZvciAoY29uc3QgRnVuYyBvZiBkYi5kYXRhKSB7XG4gICAgICAgIGlmIChGdW5jWydFU1BBw5FPTCddLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHR5cGU6IEZ1bmMuRnVuY1R5cGUgPSBGdW5jWydGdW5jJ11cbiAgICAgICAgICAgIGZ1bmNEZXNjcmlwdGlvbnMuc2V0KHR5cGUsIEZ1bmNbJ0VTUEHDkU9MJ10pXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBmdW5jRGVzY3JpcHRpb25zID0gbmV3IE1hcDxGdW5jLkZ1bmNUeXBlLCBzdHJpbmc+KFtcbiAgICBbRnVuYy5GdW5jVHlwZS5BQlNPUkJfTlBUVVJOLCAnQWJzb3JiIENoYXJnZSddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkFERF9TVEFURSwgJ0FwcGx5IEJ1ZmYnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5BRERfU1RBVEVfU0hPUlQsICdBcHBseSBCdWZmJ10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuQ0FSRF9SRVNFVCwgJ1NodWZmbGUgQ2FyZHMnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlAsICdEZWFsIERhbWFnZSddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkRBTUFHRV9OUF9IUFJBVElPX0xPVywgJ0RlYWwgRGFtYWdlIHdpdGggQm9udXMgZm9yIExvdyBIZWFsdGgnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlBfSU5ESVZJRFVBTCwgJ0RlYWwgRGFtYWdlIHdpdGggQm9udXMgdG8gVHJhaXQnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlBfSU5ESVZJRFVBTF9TVU0sICdEZWFsIERhbWFnZSB3aXRoIEJvbnVzIHBlciBUcmFpdCddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkRBTUFHRV9OUF9QSUVSQ0UsICdEZWFsIERhbWFnZSB0aGF0IHBpZXJjZXMgZGVmZW5zZSddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkRBTUFHRV9OUF9SQVJFLCAnRGVhbCBEYW1hZ2Ugd2l0aCBCb251cyB0byBSYXJpdHknXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlBfU1RBVEVfSU5ESVZJRFVBTF9GSVgsICdEZWFsIERhbWFnZSB3aXRoIEJvbnVzIHRvIFRyYWl0J10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuREVMQVlfTlBUVVJOLCAnRHJhaW4gQ2hhcmdlJ10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuRVZFTlRfRFJPUF9VUCwgJ0luY3JlYXNlIERyb3AgQW1vdW50J10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuRU5FTVlfRU5DT1VOVF9DT1BZX1JBVEVfVVAsICdDcmVhdGUgQ2xvbmUgb2YgRW5lbXknXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5FTkVNWV9FTkNPVU5UX1JBVEVfVVAsICdJbXByb3ZlIEFwcGVhcmFuY2UgUmF0ZSBvZiBFbmVteSddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkVYUF9VUCwgJ0luY3JlYXNlIE1hc3RlciBFeHAnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5FWFRFTkRfU0tJTEwsICdJbmNyZWFzZSBDb29sZG93bnMnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5GSVhfQ09NTUFORENBUkQsICdMb2NrIENvbW1hbmQgQ2FyZHMnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5GT1JDRV9JTlNUQU5UX0RFQVRILCAnRm9yY2UgSW5zdGFudCBEZWF0aCddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkdBSU5fSFAsICdSZXN0b3JlIEhQJ10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuR0FJTl9IUF9GUk9NX1RBUkdFVFMsICdBYnNvcmIgSFAnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5HQUlOX0hQX1BFUiwgJ1Jlc3RvcmUgSFAgdG8gUGVyY2VudCddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkdBSU5fTlAsICdDaGFyZ2UgTlAnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5HQUlOX05QX0JVRkZfSU5ESVZJRFVBTF9TVU0sICdDaGFyZ2UgTlAgcGVyIFRyYWl0J10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuR0FJTl9OUF9GUk9NX1RBUkdFVFMsICdBYnNvcmIgTlAnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5HQUlOX1NUQVIsICdHYWluIENyaXRpY2FsIFN0YXJzJ10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuSEFTVEVOX05QVFVSTiwgJ0luY3JlYXNlIENoYXJnZSddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLklOU1RBTlRfREVBVEgsICdBcHBseSBEZWF0aCddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkxPU1NfSFAsICdEcmFpbiBIUCddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkxPU1NfSFBfU0FGRSwgJ0RyYWluIEhQIHdpdGhvdXQga2lsbGluZyddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkxPU1NfTlAsICdEcmFpbiBOUCddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLkxPU1NfU1RBUiwgJ1JlbW92ZSBDcml0aWNhbCBTdGFycyddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLk5PTkUsICdObyBFZmZlY3QnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5RUF9EUk9QX1VQLCAnSW5jcmVhc2UgUVAgUmV3YXJkJ10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuUVBfVVAsICdJbmNyZWFzZSBRUCBSZXdhcmQnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5SRVBMQUNFX01FTUJFUiwgJ1N3YXAgbWVtYmVycyddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLlNFUlZBTlRfRlJJRU5EU0hJUF9VUCwgJ0luY3JlYXNlIEJvbmQgR2FpbiddLFxuICAgIFtGdW5jLkZ1bmNUeXBlLlNIT1JURU5fU0tJTEwsICdSZWR1Y2UgQ29vbGRvd25zJ10sXG4gICAgW0Z1bmMuRnVuY1R5cGUuU1VCX1NUQVRFLCAnUmVtb3ZlIEVmZmVjdHMnXSxcbiAgICBbRnVuYy5GdW5jVHlwZS5VU0VSX0VRVUlQX0VYUF9VUCwgJ0luY3JlYXNlIE15c3RpYyBDb2RlIEV4cCddLFxuXSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUJ1ZmZBY3Rpb25TZWN0aW9uKHNlY3Rpb25zOiBGdW5jRGVzY3JpcHRvclNlY3Rpb25zLCBmdW5jOiBGdW5jLkZ1bmMsIGRhdGFWYWw6IERhdGFWYWwuRGF0YVZhbCk6IHZvaWQge1xuICAgIGNvbnN0IHNlY3Rpb24gPSBzZWN0aW9ucy5hY3Rpb24sXG4gICAgICAgIHBhcnRzID0gc2VjdGlvbi5wYXJ0cztcblxuICAgIHBhcnRzLnB1c2goJ0FwbGljYScpO1xuICAgIFxuICAgIGZ1bmMuYnVmZnMuZm9yRWFjaCgoYnVmZiwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKGluZGV4ID4gMClcbiAgICAgICAgICAgIHBhcnRzLnB1c2goJyYnKTtcblxuICAgICAgICBjb25zdCBCdWZmID0gbmV3IEJ1ZmZEZXNjcmlwdGlvbigpLmV4cG9ydChidWZmKTtcbiAgICAgICAgcGFydHMucHVzaChCdWZmKTtcbiAgICB9KTtcblxuICAgIGlmIChcbiAgICAgICAgZnVuYy5idWZmc1swXT8udHlwZSA9PT0gQnVmZi5CdWZmVHlwZS5GSUVMRF9JTkRJVklEVUFMSVRZXG4gICAgICAgIHx8IGZ1bmMuYnVmZnNbMF0/LnR5cGUgPT09IEJ1ZmYuQnVmZlR5cGUuQ0hBTkdFX0NPTU1BTkRfQ0FSRF9UWVBFXG4gICAgKSB7XG4gICAgICAgIHNlY3Rpb25zLmFtb3VudC5wcmVwb3NpdGlvbiA9ICcgJztcbiAgICB9XG5cbiAgICBzZWN0aW9ucy50YXJnZXQucHJlcG9zaXRpb24gPSAnYSc7XG4gICAgaWYgKFxuICAgICAgICBmdW5jLmJ1ZmZzWzBdPy50eXBlID09PSBCdWZmLkJ1ZmZUeXBlLkNPTU1BTkRBVFRBQ0tfRlVOQ1RJT05cbiAgICAgICAgfHwgZnVuYy5idWZmc1swXT8udHlwZSA9PT0gQnVmZi5CdWZmVHlwZS5OUEFUVEFDS19QUkVWX0JVRkZcbiAgICApIHtcbiAgICAgICAgc2VjdGlvbnMudGFyZ2V0LnByZXBvc2l0aW9uID0gJ3BhcmEnO1xuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBoYW5kbGVDbGVhbnNlQWN0aW9uU2VjdGlvbihzZWN0aW9uczogRnVuY0Rlc2NyaXB0b3JTZWN0aW9ucywgZnVuYzogRnVuYy5GdW5jLCBkYXRhVmFsOiBEYXRhVmFsLkRhdGFWYWwpOiB2b2lkIHtcbiAgICBjb25zdCBzZWN0aW9uID0gc2VjdGlvbnMuYWN0aW9uLFxuICAgICAgICBwYXJ0cyA9IHNlY3Rpb24ucGFydHM7XG5cbiAgICBwYXJ0cy5wdXNoKGZ1bmNEZXNjcmlwdGlvbnMuZ2V0KGZ1bmMuZnVuY1R5cGUpID8/IGZ1bmMuZnVuY1R5cGUpO1xuXG4gICAgaWYgKGZ1bmMudHJhaXRWYWxzPy5sZW5ndGgpIHtcbiAgICAgICAgcGFydHMucHVzaCgnY29uJyk7XG5cbiAgICAgICAgZnVuYy50cmFpdFZhbHMuZm9yRWFjaCgodHJhaXQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPiAwKVxuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2goJ28nKTtcblxuICAgICAgICAgICAgcGFydHMucHVzaChuZXcgVHJhaXREZXNjcmlwdGlvbih0cmFpdCkuZXhwb3J0KCkpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZWN0aW9ucy50YXJnZXQucHJlcG9zaXRpb24gPSAnZW4nO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVDaGFyZ2VOcFBlclRyYWl0QWN0aW9uU2VjdGlvbihzZWN0aW9uczogRnVuY0Rlc2NyaXB0b3JTZWN0aW9ucywgZnVuYzogRnVuYy5GdW5jLCBkYXRhVmFsOiBEYXRhVmFsLkRhdGFWYWwpOiB2b2lkIHtcbiAgICBjb25zdCBzZWN0aW9uID0gc2VjdGlvbnMuYWN0aW9uLFxuICAgICAgICBwYXJ0cyA9IHNlY3Rpb24ucGFydHM7XG5cbiAgICBwYXJ0cy5wdXNoKCdDYXJnYSBOUCBwb3InKTtcblxuICAgIGlmIChmdW5jLnRyYWl0VmFscz8ubGVuZ3RoKSB7XG4gICAgICAgIGZ1bmMudHJhaXRWYWxzLmZvckVhY2goKHRyYWl0LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgaWYgKGluZGV4ID4gMClcbiAgICAgICAgICAgICAgICBwYXJ0cy5wdXNoKCcmJyk7XG5cbiAgICAgICAgICAgIHBhcnRzLnB1c2gobmV3IFRyYWl0RGVzY3JpcHRpb24odHJhaXQpLmV4cG9ydCgpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcGFydHMucHVzaCgndHJhaXRzJyk7XG5cbiAgICBzZWN0aW9ucy5hbW91bnQucHJlcG9zaXRpb24gPSAncG9yJztcbiAgICBzZWN0aW9ucy50YXJnZXQucHJlcG9zaXRpb24gPSAncGFyYSc7XG59XG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKHNlY3Rpb25zOiBGdW5jRGVzY3JpcHRvclNlY3Rpb25zLCBmdW5jOiBGdW5jLkZ1bmMsIGRhdGFWYWw6IERhdGFWYWwuRGF0YVZhbCk6IHZvaWQge1xuICAgIGNvbnN0IHNlY3Rpb24gPSBzZWN0aW9ucy5hY3Rpb24sXG4gICAgICAgIHBhcnRzID0gc2VjdGlvbi5wYXJ0cztcblxuICAgIGlmIChmdW5jLmZ1bmNUeXBlID09PSBGdW5jLkZ1bmNUeXBlLkFERF9TVEFURSB8fCBmdW5jLmZ1bmNUeXBlID09PSBGdW5jLkZ1bmNUeXBlLkFERF9TVEFURV9TSE9SVCkge1xuICAgICAgICBoYW5kbGVCdWZmQWN0aW9uU2VjdGlvbihzZWN0aW9ucywgZnVuYywgZGF0YVZhbCk7XG5cbiAgICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAoZnVuYy5mdW5jVHlwZSA9PT0gRnVuYy5GdW5jVHlwZS5TVUJfU1RBVEUpIHtcbiAgICAgICAgaGFuZGxlQ2xlYW5zZUFjdGlvblNlY3Rpb24oc2VjdGlvbnMsIGZ1bmMsIGRhdGFWYWwpO1xuXG4gICAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKGZ1bmMuZnVuY1R5cGUgPT09IEZ1bmMuRnVuY1R5cGUuR0FJTl9OUF9CVUZGX0lORElWSURVQUxfU1VNKSB7XG4gICAgICAgIGhhbmRsZUNoYXJnZU5wUGVyVHJhaXRBY3Rpb25TZWN0aW9uKHNlY3Rpb25zLCBmdW5jLCBkYXRhVmFsKTtcblxuICAgICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChcbiAgICAgICAgZnVuYy5mdW5jVHlwZSA9PT0gRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlBcbiAgICAgICAgfHwgZnVuYy5mdW5jVHlwZSA9PT0gRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlBfSFBSQVRJT19MT1dcbiAgICAgICAgfHwgZnVuYy5mdW5jVHlwZSA9PT0gRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlBfSU5ESVZJRFVBTFxuICAgICAgICB8fCBmdW5jLmZ1bmNUeXBlID09PSBGdW5jLkZ1bmNUeXBlLkRBTUFHRV9OUF9JTkRJVklEVUFMX1NVTVxuICAgICAgICB8fCBmdW5jLmZ1bmNUeXBlID09PSBGdW5jLkZ1bmNUeXBlLkRBTUFHRV9OUF9QSUVSQ0VcbiAgICAgICAgfHwgZnVuYy5mdW5jVHlwZSA9PT0gRnVuYy5GdW5jVHlwZS5EQU1BR0VfTlBfUkFSRVxuICAgICAgICB8fCBmdW5jLmZ1bmNUeXBlID09PSBGdW5jLkZ1bmNUeXBlLkRBTUFHRV9OUF9TVEFURV9JTkRJVklEVUFMX0ZJWFxuICAgICkge1xuICAgICAgICBwYXJ0cy5wdXNoKCdEYcOxYScpO1xuICAgICAgICBzZWN0aW9ucy5hbW91bnQucHJlcG9zaXRpb24gPSAndW4nO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc3dpdGNoIChmdW5jLmZ1bmNUeXBlKSB7XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5BQlNPUkJfTlBUVVJOOlxuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuR0FJTl9IUF9GUk9NX1RBUkdFVFM6XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5HQUlOX05QX0ZST01fVEFSR0VUUzpcbiAgICAgICAgICAgIHNlY3Rpb25zLmFtb3VudC5wcmVwb3NpdGlvbiA9ICcgJztcbiAgICAgICAgICAgIHNlY3Rpb25zLnRhcmdldC5wcmVwb3NpdGlvbiA9ICdhbCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkNBUkRfUkVTRVQ6XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5HQUlOX1NUQVI6XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5MT1NTX1NUQVI6XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5OT05FOlxuICAgICAgICAgICAgc2VjdGlvbnMudGFyZ2V0LnNob3dpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuREVMQVlfTlBUVVJOOlxuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuTE9TU19IUDpcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkxPU1NfSFBfU0FGRTpcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkxPU1NfTlA6XG4gICAgICAgICAgICBzZWN0aW9ucy5hbW91bnQucHJlcG9zaXRpb24gPSAnICc7XG4gICAgICAgICAgICBzZWN0aW9ucy50YXJnZXQucHJlcG9zaXRpb24gPSAnYWwnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5FTkVNWV9FTkNPVU5UX0NPUFlfUkFURV9VUDpcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkVORU1ZX0VOQ09VTlRfUkFURV9VUDpcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkZJWF9DT01NQU5EQ0FSRDpcbiAgICAgICAgICAgIHNlY3Rpb25zLmFtb3VudC5zaG93aW5nID0gZmFsc2U7XG4gICAgICAgICAgICBzZWN0aW9ucy50YXJnZXQuc2hvd2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5FVkVOVF9EUk9QX1VQOlxuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuRVhQX1VQOlxuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuUVBfRFJPUF9VUDpcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLlFQX1VQOlxuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuU0VSVkFOVF9GUklFTkRTSElQX1VQOlxuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuVVNFUl9FUVVJUF9FWFBfVVA6XG4gICAgICAgICAgICBzZWN0aW9ucy5jaGFuY2Uuc2hvd2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgc2VjdGlvbnMuYW1vdW50LnByZXBvc2l0aW9uID0gJ3VuJztcbiAgICAgICAgICAgIHNlY3Rpb25zLnRhcmdldC5zaG93aW5nID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkVYVEVORF9TS0lMTDpcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkdBSU5fSFA6XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5HQUlOX05QOlxuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuSEFTVEVOX05QVFVSTjpcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLlNIT1JURU5fU0tJTEw6XG4gICAgICAgICAgICBzZWN0aW9ucy5hbW91bnQucHJlcG9zaXRpb24gPSAnICc7XG4gICAgICAgICAgICBzZWN0aW9ucy50YXJnZXQucHJlcG9zaXRpb24gPSAnYSc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkZPUkNFX0lOU1RBTlRfREVBVEg6XG4gICAgICAgIGNhc2UgRnVuYy5GdW5jVHlwZS5JTlNUQU5UX0RFQVRIOlxuICAgICAgICAgICAgc2VjdGlvbnMuYW1vdW50LnNob3dpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHNlY3Rpb25zLnRhcmdldC5wcmVwb3NpdGlvbiA9ICdlbic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGdW5jLkZ1bmNUeXBlLkdBSU5fSFBfUEVSOlxuICAgICAgICAgICAgc2VjdGlvbnMuYW1vdW50LnByZXBvc2l0aW9uID0gJyAnO1xuICAgICAgICAgICAgc2VjdGlvbnMudGFyZ2V0LnByZXBvc2l0aW9uID0gJ2FsJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEZ1bmMuRnVuY1R5cGUuUkVQTEFDRV9NRU1CRVI6XG4gICAgICAgICAgICBzZWN0aW9ucy5hbW91bnQuc2hvd2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgc2VjdGlvbnMudGFyZ2V0LnByZXBvc2l0aW9uID0gJ2Nvbic7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcGFydHMucHVzaChmdW5jRGVzY3JpcHRpb25zLmdldChmdW5jLmZ1bmNUeXBlKSA/PyBmdW5jLmZ1bmNUeXBlKTtcbn1cbiJdfQ==